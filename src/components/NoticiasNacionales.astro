---
import "../styles/global.css";
import { fetchFromApi, STRAPI_BASE_URL } from "../lib/strapi";

interface Noticia {
  documentId: string;
  titulo: string;
  descripcion: string;
  fecha: string;
  autor: string;
  imagen?: {
    url: string;
    formats?: {
      large?: {
        url: string;
      };
    };
  };
}

const noticias: Noticia[] = await fetchFromApi("noticianacionals");
---

<div class="bg-gray-100">
  <div class="max-w-7xl mx-auto p-4 sm:p-6 lg:p-8">
    <div class="mb-8">
      <h2 class="text-2xl font-bold text-gray-900">Noticias Nacionales</h2>
      <div class="relative mt-2 h-0.5 bg-gray-200">
        <div class="absolute top-0 left-0 h-0.5 w-10 bg-red-600"></div>
      </div>
    </div>

    <!-- destacadas -->
    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-10">
      {noticias.slice(0, 4).map((noticia, index) => (
          <a href={`/noticiasnacional/${noticia.documentId}`} class={`col-span-1 ${index === 0 ? "md:col-span-2 row-span-1 md:row-span-2 h-96" : index === 1 ? "md:col-span-2 h-48 md:h-auto" : "md:col-span-1 h-48"} flex items-end p-4 relative overflow-hidden group`}>
            {noticia.imagen?.formats?.large?.url && (
                <img
                    src={`${STRAPI_BASE_URL}${noticia.imagen.formats.large.url}`}
                    alt={noticia.titulo}
                    class="absolute inset-0 w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
                />
            )}
            <div class="text-white relative z-10 bg-black/30 p-4 rounded">
              <p class="text-sm font-semibold uppercase tracking-wider inline-block px-2 py-1 bg-red-600">
                {["Política", "COVID-19", "Política", "Economía"][index] || "General"}
              </p>
              <h2 class={`${index === 0 ? "text-2xl" : "text-lg"} font-bold mt-2`}>
                {noticia.titulo}
              </h2>
              <p class="text-xs mt-1">Por {noticia.autor} | {noticia.fecha}</p>
            </div>
          </a>
      ))}
    </div>

    <!-- inferiores -->
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4">
      {noticias.slice(4, 8).map((noticia) => (
          <a href={`/noticiasnacional/${noticia.documentId}`} class="bg-white p-2 shadow-sm hover:shadow-md transition duration-300 block">
            <div class="h-32 bg-gray-200 mb-2 overflow-hidden">
              {noticia.imagen?.formats?.large?.url && (
                  <img
                      src={`${STRAPI_BASE_URL}${noticia.imagen.formats.large.url}`}
                      alt={noticia.titulo}
                      class="w-full h-full object-cover"
                  />
              )}
            </div>
            <p class="text-xs text-gray-600">Por {noticia.autor} | {noticia.fecha}</p>
            <h3 class="text-base font-semibold mt-1">{noticia.titulo}</h3>
          </a>
      ))}
    </div>
  </div>
</div>
